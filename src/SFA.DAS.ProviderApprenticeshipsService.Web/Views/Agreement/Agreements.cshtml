@using Newtonsoft.Json;
@model SFA.DAS.ProviderApprenticeshipsService.Web.Models.Agreement.AgreementsViewModel

@{
    ViewBag.Title = "Organisations and Agreements";
    ViewBag.PageID = "organisations-and-agreements";
}



<h1 class="heading-xlarge">Organisations and agreements</h1>
<p>Listed below is every organisation you work with on the apprenticeship service and their agreement ID.</p>
<p>You will need to add the agreement ID to the individualised learner record (ILR), and to your learner management system (LMS), if you use one. This allows us to provide users with better error messages whenever a data mismatch occurs.</p>
<div class="grid-row">
    <div class="column-two-thirds">
        <form method="get" action="@Url.Action("Agreements")">
            <div class="app-search-form">
                <label for="search-form-example" class="form-label">
                    Search organisation name
                </label>
                <div class="app-search-form__group">
                    <input id="search-form-example" title="Search" name="organisation" value="@Model.SearchText" class="form-control app-search-form__input app-autocomplete" type="text">
                    <div class="app-search-form__button-wrap">
                        <button class="button app-search-form__button" type="submit">
                            Search Organisation
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

@if (!String.IsNullOrEmpty(@Model.SearchText))
{
    <p><a href="@Url.Action("Agreements")">Clear search</a></p>
}

@if (Model.CommitmentAgreements.Count() == 0)
{
    <p>0 organisations match <span class="strong">'@Model.SearchText'</span></p>
}
else
{
    <table>
        <thead>
            <tr>
                <th scope="col">Organisation</th>
                <th scope="col">Agreement ID</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var cohortAgreement in Model.CommitmentAgreements)
            {
                <tr>
                    <td>
                        @cohortAgreement.OrganisationName
                    </td>
                    <td>
                        @cohortAgreement.AgreementID
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

@section PreFooterJS {
    <script>
        var autoCompleteSource = @Html.Raw(JsonConvert.SerializeObject(Model.AllProviderOrganisationNames));
    </script>
}

@section breadcrumb {
    <div class="breadcrumbs">
        <a href="javascript:window.history.back();" class="back-link">Back</a>
    </div>
}